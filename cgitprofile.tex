\subsubsection{Cgit Profil}

\begin{lstlisting}[style=Java, caption=Beispiel Cgit Profil]
cgitUrl = "http://hjemli.net/git/cgit/snapshot/cgit-0.9.0.2.tar.gz"
cgitMd5Url = "cgit-0.9.0.2.tar.gz.md5"
server {
    profiles {
        create_profile("ubuntu") {
            system {
                packages_install_command 'export DEBIAN_FRONTEND=noninteractive; /usr/bin/apt-get -q -y update && /usr/bin/apt-get -q -y install'
                chown_command '/bin/chown -R'
                chmod_command '/bin/chmod -R'
                usermod_command "/usr/sbin/usermod"
            }
            httpd {
                handler 'apache2'
                configuration_directory '/etc/apache2'
                restart_command '/etc/init.d/apache2 restart'
                status_command '/usr/sbin/apache2ctl configtest'
                status_command_expected '.*Syntax OK.*'
                packages 'apache2'

                domain_web_directory_prefix '/var/www/$domain_name$/web'
                domain_ssl_directory_prefix '/var/www/$domain_name$/ssl'
                domain_page_directory_prefix '/var/www/$domain_name$/$page_name$/web'
                domain_web_group 'www-data'
                domain_web_owner 'www-data'
                domain_web_directory_mod 'a-rx,o-w'
                domain_ssl_group 'root'
                domain_ssl_owner 'root'
                domain_ssl_directory_mod 'o-wrx'

                apache2_a2enmod_command '/usr/sbin/a2enmod'
                apache2_mods 'ssl, rewrite'

                cgit_url cgitUrl
                cgit_hash_url cgitMd5Url
                cgit_cache_root "/var/cache/cgit"
                cgit_update_apache_user true
            }
        }
    }
}
\end{lstlisting}

Die Cgit Profil-Directiven befinden sich im httpd-Block und haben das cgit-Prefix. Das Beispiel zeigt eine Konfiguration für einen Ubuntu 10.10 Server mit Apache2 als den httpd-Server.

Im folgendem werden die gültigen Direktive erklärt.

\paragraph{usermod\_command}

\directive{usermod\_command} erwartet eine Zeichenfolge, die das usermod-Kommando bezeichnen. Es muss dafür gesorgen werden, dass der Apache2 Server auch die Git-Repositories lesen kann damit Cgit sie anzeigen kann. Das Programm wird automatisch den Apache2-Benutzer zu den Gruppen hinzufügen, die Lesezugriff auf die Git-Repositories haben, wenn die \directive{cgit\_update\_apache\_user} gesetzt ist.

\paragraph{cgit\_url}

Die optionale \directive{cgit\_url} erwartet eine Zeichenfolge, die die URL enthält von wo man Cgit herunter laden kann. Diese Direktive ist nur nötig, wenn das System kein Cgit-Paket anbietet.

\paragraph{cgit\_hash\_url}

Die optionale \directive{cgit\_hash\_url} erwartet eine Zeichenfolge, die die URL enthält von wo man das Hash zum Cgit-Archiv herunter laden kann. Diese Direktive ist nur nötig, wenn das System kein Cgit-Paket anbietet und man das Cgit-Archiv automatisch überprüfen will. Auf der Homepage von Cgit befindet sich leider kein Hash-Datei zum herunter laden, aber man kann einmal eine Hash-Datei erstellen und diese benutzen.

\paragraph{cgit\_cache\_root}

Die \directive{cgit\_cache\_root} erwartet eine Zeichenfolge, die das Verzeichnis ist, wo Cgit sein Cache speichern kann. Für jede Cgit Installation wird ein neues Unterverzeichnis unter diesem Verzeichnis erstellt, damit die Installationen sich nicht gegenseitig beeinflussen können.

\paragraph{cgit\_update\_apache\_user}

Die \directive{cgit\_update\_apache\_user} erwartet entweder \code{true} oder \code{false}, je nach dem ob das Programm automatisch den Apache2-Benutzer zu den Gruppen hinzufügen soll, die Lesezugriff auf die Git-Repositories haben. Falls der Wert \code{true} ist, dann wird der in der \directive{usermod\_command} Kommando benutzt, um den Apache2-Benutzer zu den Gruppen hinzuzufügen.
